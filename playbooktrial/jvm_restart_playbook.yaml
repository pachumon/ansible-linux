---
- name: Verify JVM logs and restart service
  hosts: "{{ host }}"
  gather_facts: True

  tasks:
    - name: check if specific file exist 
      become: true
      find:
        paths: "{{ filepath }}"
        patterns: '*logs.log'
        recurse: no           
      register: found_files   

    - debug:       
        var: found_files

    - name: Check if error text is present
      shell: grep -q 'error' "{{ filepath }}/{{ filename }}"
      register: grep_result
      ignore_errors: yes  

    - name: Display the result
      debug:
        msg: "The line is {{ 'present' if grep_result.rc == 0 else 'not present' }} in the file"
    
    - name: Run a command
      when: grep_result.rc == 0
      command: echo run command here for jvm restart